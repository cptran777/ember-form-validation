<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: mixins/form-validation.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: mixins/form-validation.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import Ember from 'ember';

import validateItem from 'ember-form-validation/utils/validate-item';

export default Ember.Mixin.create({
  /**
   * Looks for a specified key in the validate object passed
   * in by the user in the 'validate' object. Will default to
   * 'form' if nothing is specified
   * @return {string}
   */
  _validatorKey: Ember.computed('validate', function() {
    const validate = this.get('validate');

    return validate.formName ? validate.formName : 'form';
  }),

  /**
   * Returns a list of validation props that the user has
   * specified in the validation object
   * @param {object} validate - the user specified validation
   * object
   * @return {array} - an array of strings specifying the keys
   */
  _validatorItems: Ember.computed('validate', function() {
    const form = this.get('validate').form;

    return Object.keys(form || {});
  }),

  /**
   * An object that holds the errors that emerge from the
   * validation process that can be passed into the component
   * @type {object}
   */
  validationErrors: Ember.computed(function() {
    return Object.create({});
  }),

  /**
   * Shows validation errors as a list
   * @return {Array}
   */
  validationErrorsList: Ember.computed('validationErrors', function() {
    const validationErrors = this.get('validationErrors');
    const properties = Object.keys(validationErrors);

    return properties.map(prop => ({
      property: prop,
      message: validationErrors[prop]
    }));
  }),

  /**
   * Whether a validation error exists. Useful if realtime
   * validations are needed
   * @type {boolean}
   */
  validationErrorExists: Ember.computed('validationErrors', function() {
    const validationErrors = this.get('validationErrors');
    const errorKeys = Object.keys(validationErrors);

    return errorKeys.reduce((result, key) =>
      result || !!validationErrors[key], false);
  }),

  actions: {
    /**
     * Method that performs the validation process
     * @method validate
     * @return {boolean} - whether or not the form was successfully
     * validated
     */
    validate_form_action(formObj) {
      let key, form, formItems, validations, validationItems;
      const validationErrors = {};

      try {
        // The key that signifies the actual property the form exists as
        key = this.get('_validatorKey');
      }
      catch (err) {
        console.log('validate-form error: Unable to verify the form. Did you create ' +
          'a validate object property on your component?');
      }
      // Uses the key to get the form itself
      form = formObj || this.get(key);

      if (!form) {
        console.log('validate-form error: Unable to retrieve form. Did you create a ' +
          'form property or specify another object as the form property by using ' +
          'formName in validate?');
      }
      // Gets the properties on the form that will be checked
      formItems = Object.keys(form);
      // Validation criteria specified on the component by the user
      validations = this.get('validate').form;
      // Enumerates through the validator and gets the properties to be tested
      validationItems = this.get('_validatorItems');

      validationItems.forEach(item => {
        let formItem = form[item];

        validateItem(item, formItem, validations[item], validationErrors);
      });

      this.set('validationErrors', validationErrors);
    }
  }
});
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#_validatorItems">_validatorItems</a></li><li><a href="global.html#_validatorKey">_validatorKey</a></li><li><a href="global.html#defaultError">defaultError</a></li><li><a href="global.html#testDate">testDate</a></li><li><a href="global.html#validate">validate</a></li><li><a href="global.html#validationErrorExists">validationErrorExists</a></li><li><a href="global.html#validationErrors">validationErrors</a></li><li><a href="global.html#validationErrorsList">validationErrorsList</a></li><li><a href="global.html#validationFormats">validationFormats</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.4.3</a> on Tue Mar 14 2017 17:15:56 GMT-0700 (PDT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
